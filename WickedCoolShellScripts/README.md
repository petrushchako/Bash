# Wicked Cool Shell Scripts

### Table of contents

|                                               |                                                 |                                |
|:---------------------------------------------:|-------------------------------------------------|--------------------------------|
| **THE MISSING CODE LIBRARY**                  |                                                 |                                |
|**1**                                          | Finding Program in the PATH                     | `1.inpath.sh`                  |
|**2**                                          | Validating Input: Alphanumeric Only             | `2.validAlphaPath.sh`          |
|**3**                                          | Normalizing Date Formats                        |                                |
|**4**                                          | Presenting Large Numbers Attractively           |                                |
|**5**                                          | Validating Integer Input                        |                                |
|**6**                                          | Validating Floating-Point Inout                 |                                |
|**7**                                          | Validating Date Formats                         |                                |
|**8**                                          | Sidestepping Toor echo Implementations          |                                |
|**9**                                          | An Arbitrary-Precision Floating-Point Calculator|                                |
|**10**                                         | Locking Files                                   |                                |
|**11**                                         | ANSI Color Squences                             |                                |
|**12**                                         | Building a Shell Scripts Library                |                                |
|**13**                                         | Debugging Shell Scripts                         |                                |
|                                               |                                                 |                                |
|**IMPROVING ON USER COMMANDS**                 |                                                 |                                |
|**14**                                         | Formatting Long Lines                           |                                |
|**15**                                         | Backing Up Files as They're Removed             |                                |
|**16**                                         | Working with the Removed File Archive           |                                |
|**17**                                         | Logging File Removals                           |                                |
|**18**                                         | Displaying The Contents of Directories          |                                |
|**19**                                         | Locating Files by Filename                      |                                |
|**20**                                         | Emulating Other Environments: MS-DOS            |                                |
|**21**                                         | Displaying Time in Different Time Zones         |                                |
|                                               |                                                 |                                |
|**CREATING UTILITIES**                         |                                                 |                                |
|**22**                                         | A Reminder Utility                              |                                |
|**23**                                         | An Interactive Calculator                       |                                |
|**24**                                         | Converting Temperatures                         |                                |
|**25**                                         | Calculating Loan Payments                       |                                |
|**26**                                         | Keeping Track of Events                         |                                |
|                                               |                                                 |                                |
|**TWEEKING UNIX**                              |                                                 |                                |
|**27**                                         | Display a File with Line Numbers                |                                |
|**28**                                         | Wrapping Only Long Lines                        |                                |
|**29**                                         | Display a File with Additional information      |                                |
|**30**                                         | Emulating GNU-Style Flags with quota            |                                |
|**31**                                         | Making sftp Look More Like ftp                  |                                |
|**32**                                         | Fixing grep                                     |                                |
|**33**                                         | Working with Compressed Files                   |                                |
|**34**                                         | Ensuring Maximally Compressed Files             |                                |
|                                               |                                                 |                                |
|**SYSTEM ADMINISTRATION: MANAGING USERS**      |                                                 |                                |
|**35**                                         | Analyzing Disk Usage                            |                                |
|**36**                                         | Reporting Disk Hogs                             |                                |
|**37**                                         | Improving the Readability of df Output          |                                |
|**38**                                         | Figuring Out Available Disk Space               |                                |
|**39**                                         | Implementing a Secure locate                    |                                |
|**40**                                         | Adding Users to the System                      |                                |
|**41**                                         | Suspending a User Account                       |                                |
|**42**                                         | Deleting a User Account                         |                                |
|**43**                                         | Validating the User Environment                 |                                |
|**44**                                         | Cleaning Us After Guests Leave                  |                                |
|                                               |                                                 |                                |
|**SYSTEM ADMINISTRATION: SYSTEM MAINTENANCE**  |                                                 |                                |
|**45**                                         | Tracking Set User ID Applications               |                                |
|**46**                                         | Setting the System Date                         |                                |
|**47**                                         | Killing Processes by Name                       |                                |
|**48**                                         | Validating User crontab Entries                 |                                |
|**49**                                         | Ensuring that System cron Jobs Are Run          |                                |
|**50**                                         | Rotating Log Files                              |                                |
|**51**                                         | Managing backups                                |                                |
|**52**                                         | Backing Up Directories                          |                                |
|                                               |                                                 |                                |
|**WEB AND INTERNET USERS**                     |                                                 |                                |
|**53**                                         | Downloading Files via FTP                       |                                |
|**54**                                         | Extracting URLs from a Web page                 |                                |
|**55**                                         | Getting GitHub User Information                 |                                |
|**56**                                         | ZIP Code Lookup                                 |                                |
|**57**                                         | Area Code lookup                                |                                |
|**58**                                         | Keeping Track of the Weather                    |                                |
|**59**                                         | Digging Up Movie Info from IMDb                 |                                |
|**60**                                         | Calculating Currency Values                     |                                |
|**61**                                         | Retrieving Bitcoin Address Information          |                                |
|**62**                                         | Tracking Changes on Web Pages                   |                                |
|                                               |                                                 |                                |
|**WEBMASTER HACKS**                            |                                                 |                                |
|**63**                                         | Seeing the CGI Environment                      |                                |
|**64**                                         | Logging Web Events                              |                                |
|**65**                                         | Building Web Pages on the Fly                   |                                |
|**66**                                         | Turning Web Pages into Email Messages           |                                |
|**67**                                         | Creating a Web-Based Photo Album                |                                |
|**68**                                         | Displaying Random Text                          |                                |
|                                               |                                                 |                                |
|**WEB AND INTERNET ADMINISTRATION**            |                                                 |                                |
|**69**                                         | Identifying Broken Internal Links               |                                |
|**70**                                         | Reporting Broken External Links                 |                                |
|**71**                                         | Managing Apache Passwords                       |                                |
|**72**                                         | Synchronizing Files with SFTP                   |                                |
|                                               |                                                 |                                |
|**INTERNET SERVER ADMINISTRATION**             |                                                 |                                |
|**73**                                         | Exploring the Apache access_log                 |                                |
|**74**                                         | Understanding Search Engine Traffic             |                                |
|**75**                                         | Exploring the Apache error_log                  |                                |
|**76**                                         | Avoiding Disaster with Remote Archive           |                                |
|**77**                                         | Monitoring Network Status                       |                                |
|**78**                                         | Renicing Tasks by Process Name                  |                                |
|                                               |                                                 |                                |
|**OS X SCRIPTS**                               |                                                 |                                |
|**79**                                         | Automating screencapture                        |                                |
|**80**                                         | Setting the Terminal Title Dynamically          |                                |
|**81**                                         | Producing Summary Listing of iTunes Libraries   |                                |
|**82**                                         | Fixing the open Command                         |                                |
|                                               |                                                 |                                |
|**SHELL SCRIPT FUN AND GAMES**                 |                                                 |                                |
|**83**                                         | Unscramble: A Word Game                         |                                |
|**84**                                         | Hangman: Guess the Word Before It's Too Late    |                                |
|**85**                                         | A State Capital Quiz                            |                                |
|**86**                                         | Is That Number a Prime?                         |                                |
|**87**                                         | Let's Roll Some Dice                            |                                |
|**88**                                         | Acey Deuecey                                    |                                |
|                                               |                                                 |                                |
|**WORKING WITH THE CLOUD**                     |                                                 |                                |
|**89**                                         | Keeping Dropbox Running                         |                                |
|**90**                                         | Syncing Dropbox                                 |                                |
|**91**                                         | Creating Slide Shows from Cloud Photo Streams   |                                |
|**92**                                         | Syncing Files with Google Drive                 |                                |
|**93**                                         | The Computer Says                               |                                |
|                                               |                                                 |                                |
|**IMAGEMAGICK AND WORKING WITH GRAPHICS FILES**|                                                 |                                |
|**94**                                         | A Smarter Image Size Analyzer                   |                                |
|**95**                                         | Watermarking Images                             |                                |
|**96**                                         | Framing Images                                  |                                |
|**97**                                         | Creating Image Thumbnails                       |                                |
|**98**                                         | Interpreting GPS Geolocation Information        |                                |
|                                               |                                                 |                                |
|**DAYS AND DATES**                             |                                                 |                                |
|**99**                                         | Finding the Day of a Specific Date in the Past  |                                |
|**100**                                        | Calculating Days Between Dates                  |                                |
|**101**                                        | Calculating Days Until a Specified Date         |                                |
|                                               |                                                 |                                |
|**BONUS SCRIPTS**                              |                                                 |                                |
|**102**                                        | Bulk-Renaming Files                             |                                |
|**103**                                        | Bulk-Running Commands on Multiprcessor Machines |                                |
|**104**                                        | Finding the Phase of the Moon                   |                                |




<hr>

# Bash Scripting Fundamentals

## 1. What Is Bash?
**Bash (Bourne Again SHell)** is a command interpreter and scripting language for Unix/Linux systems.  
It supports:
- Command execution  
- Variables and arithmetic  
- Conditionals and loops  
- Functions and error handling  
- Text processing with pipes, redirections, and tools (`grep`, `sed`, `awk`, etc.)

## 2. Running Bash Scripts
### Create and run a script
```bash
#!/usr/bin/env bash
echo "Hello world"
````

Save as `myscript.sh`, then:

```bash
chmod +x myscript.sh
./myscript.sh
```

You can also run:

```bash
bash myscript.sh
```

The `#!/usr/bin/env bash` line is the **shebang** — it tells the system which interpreter to use.

---

## 3. Variables
### Declaring variables

```bash
name="Alice"
age=25
```

> No spaces around `=`!

### Accessing variables
```bash
echo "Name: $name, Age: $age"
```

### Read-only variables
```bash
readonly company="TechCorp"
```

### Environment variables
```bash
export PATH="$PATH:/opt/bin"
```

### Reading user input
```bash
read -p "Enter your name: " username
echo "Hi $username!"
```

## 4. Data Types (Primitives)
Bash treats everything as **strings**, but supports numeric arithmetic.

### Integer arithmetic
```bash
a=5
b=3

# In Bash, the double parentheses with $ are used for arithmetic expansion.
# It allows you to perform integer math operations directly inside your script.
sum=$((a + b))
echo "$a + $b = $sum"
```

### String operations
```bash
greet="hello"
echo "${greet^^}"   # HELLO (uppercase)
echo "${greet,,}"   # hello (lowercase)
echo "${#greet}"    # string length = 5
```

<br>

## 5. Arrays
### Create an array
```bash
fruits=("apple" "banana" "orange")
```

### Access elements
```bash
echo "${fruits[0]}"   # apple
echo "${fruits[@]}"   # all elements
```

### Add or modify
```bash
fruits+=("grape")
fruits[1]="kiwi"
```

### Array length
```bash
echo "${#fruits[@]}"
```

### Iterate over array
```bash
for item in "${fruits[@]}"; do
  echo "$item"
done
```

<br>

## 6. Conditionals
### Basic if/else
```bash
x=10

if [ $x -gt 5 ]; then
  echo "x is greater than 5"
else
  echo "x is 5 or less"
fi
```

### String comparisons
```bash
str="hello"
if [ "$str" = "hello" ]; then
  echo "Match"
fi
```

### File tests

```bash
if [ -f /etc/passwd ]; then
  echo "File exists"
fi

if [ -d /var/log ]; then
  echo "Directory exists"
fi
```

### Common file test flags

| Test | Meaning                    |
| ---- | -------------------------- |
| `-f` | File exists and is regular |
| `-d` | Directory exists           |
| `-e` | File or directory exists   |
| `-r` | File is readable           |
| `-w` | File is writable           |
| `-x` | File is executable         |


## 7. Loops
### For loop

```bash
for i in 1 2 3 4 5; do
  echo "Number: $i"
done
```

With brace expansion:

```bash
for i in {1..5}; do
  echo "Loop $i"
done
```

Iterate files:

```bash
for file in /etc/*.conf; do
  echo "Found $file"
done
```

### While loop

```bash
count=1
while [ $count -le 5 ]; do
  echo "Count: $count"
  ((count++))
done
```

### Until loop
```bash
num=0
until [ $num -ge 3 ]; do
  echo "num is $num"
  ((num++))
done
```

## 8. Functions
### Declaring a function

```bash
greet() {
  echo "Hello, $1!"
}
```

### Calling a function
```bash
greet "Alice"
```

### Returning status codes
```bash
check_file() {
  [ -f "$1" ]
}

if check_file /etc/passwd; then
  echo "File exists"
else
  echo "Missing file"
fi
```

### Returning values (via echo)
```bash
sum() {
  echo $(( $1 + $2 ))
}

result=$(sum 5 3)
echo "Sum = $result"
```

## 9. Exit Codes and Error Handling
* Each command returns an **exit code** (`0` = success, nonzero = failure).
* You can view the last command’s exit code with `$?`.

```bash
ls /notfound
echo "Exit code: $?"
```

### Stop script on error
```bash
set -e
```

### Common safe mode
```bash
set -euo pipefail
```

* `-e`: exit on error
* `-u`: error on undefined variable
* `-o pipefail`: pipeline fails if any command fails

## 10. Input and Output Redirection
### Redirect output

```bash
command > file.txt     # stdout to file
command >> file.txt    # append
command 2> errors.txt  # stderr to file
```

### Redirect both stdout and stderr
```bash
command &> output.log
```

### Pipes
```bash
ps aux | grep nginx | wc -l
```

## 11. Command Substitution
Run a command and capture its output:
```bash
today=$(date +%F)
echo "Today's date is $today"
```

## 12. Case Statements
Simpler than multiple `if` statements:
```bash
read -p "Enter option (start|stop): " action

case $action in
  start)
    echo "Starting service..."
    ;;
  stop)
    echo "Stopping service..."
    ;;
  *)
    echo "Unknown action: $action"
    ;;
esac
```

## 13. Script Arguments (`$1`, `$2`, `$@`)

```bash
echo "Script name: $0"
echo "First arg: $1"
echo "All args: $@"
```

Loop through arguments:

```bash
for arg in "$@"; do
  echo "Arg: $arg"
done
```

## 14. Working with Files and Commands
### Check if command exists
```bash
if command -v curl &>/dev/null; then
  echo "curl installed"
else
  echo "curl missing"
fi
```

### Example: read a file line by line
```bash
while read -r line; do
  echo "Line: $line"
done < /etc/hosts
```

## 15. Practical Tips for Wicked Scripts
1. **Always start scripts with:**
   ```bash
   set -euo pipefail
   IFS=$'\n\t'
   ```

   This prevents subtle parsing errors.

2. **Use quotes** around variable expansions (`"$var"`) to prevent word splitting.
3. **Use functions** to structure code and make it reusable.
4. **Log clearly:**

   ```bash
   echo "$(date -u +"%F %T") INFO: Starting backup"
   ```

5. **Validate input early:**

   ```bash
   [[ "$var" =~ ^[0-9]+$ ]] || { echo "Not a number"; exit 1; }
   ```

## 16. Example: Putting It All Together

```bash
#!/usr/bin/env bash
# Example system check script

set -euo pipefail

check_disk() {
  local usage
  usage=$(df / | awk 'NR==2 {print $5}' | tr -d '%')
  if [ "$usage" -gt 80 ]; then
    echo "Disk usage high: ${usage}%"
  else
    echo "Disk usage normal: ${usage}%"
  fi
}

check_mem() {
  local free
  free=$(vm_stat | awk '/Pages free/ {print $3}' | tr -d '.')
  echo "Free memory pages: $free"
}

echo "=== System Health Check ==="
check_disk
check_mem
echo "Done."
```

<br><br><br>
---

## Arrays
### 1. Creating Arrays
**Indexed array (most common):**

```bash
fruits=("apple" "banana" "cherry")
```

**Add elements manually:**

```bash
fruits[3]="orange"
```

**Or declare first, then assign:**

```bash
declare -a fruits
fruits[0]="apple"
fruits[1]="banana"
```

### 2. Accessing Elements
```bash
echo "${fruits[0]}"   # apple
echo "${fruits[2]}"   # cherry
```

> Always use **double quotes** when expanding — this prevents word-splitting errors.

### 3. Getting All Elements
```bash
echo "${fruits[@]}"   # apple banana cherry orange
```

* `@` means “all elements”.
* You can also use `*`, but `@` is safer when values contain spaces.

### 4. Number of Elements
```bash
echo "${#fruits[@]}"   # 4
```

### 5. Get All Indices
```bash
echo "${!fruits[@]}"   # 0 1 2 3
```

Useful when you want to iterate with indexes.

### 6. Modifying Arrays
**Append elements:**
```bash
fruits+=("grape" "melon")
```

**Remove an element:**
```bash
unset 'fruits[1]'   # removes banana
```

**Delete entire array:**
```bash
unset fruits
```

### 7. Iterating Over Arrays
Here’s where it gets interesting.

#### a) **Loop through values**
```bash
for fruit in "${fruits[@]}"; do
  echo "I like $fruit"
done
```

> Always quote `"${fruits[@]}"` — otherwise words with spaces split incorrectly.

#### b) **Loop through indices**
```bash
for i in "${!fruits[@]}"; do
  echo "Index $i: ${fruits[$i]}"
done
```

> This is helpful when you need to modify items by index.

#### c) **C-style loop**
```bash
for ((i=0; i<${#fruits[@]}; i++)); do
  echo "${fruits[$i]}"
done
```

> Similar to loops in C, Python, or JavaScript — uses arithmetic syntax `(( ))`.

### 8. Slicing (partial access)
You can grab a slice of an array just like strings.
```bash
echo "${fruits[@]:1:2}"   # prints elements from index 1 (banana) up to 2 items
```

### 9. Copying Arrays
```bash
new_fruits=("${fruits[@]}")
```

### 10. Checking if a value exists
```bash
value="apple"
for item in "${fruits[@]}"; do
  if [[ $item == "$value" ]]; then
    echo "Found!"
  fi
done
```

Or more compact (using pattern matching):
```bash
[[ " ${fruits[@]} " =~ " $value " ]] && echo "Found!"
```

### 11. Associative Arrays (key-value pairs)
Bash 4+ supports **associative arrays** — like dictionaries.

```bash
declare -A capitals
capitals=([France]="Paris" [Italy]="Rome" [Japan]="Tokyo")

echo "${capitals[France]}"   # Paris
```

**Loop through keys:**
```bash
for country in "${!capitals[@]}"; do
  echo "$country → ${capitals[$country]}"
done
```

### Pro Tips

| Tip                      | Description                                                        |
| ------------------------ | ------------------------------------------------------------------ |
| Always use quotes        | `"${array[@]}"` preserves each element even with spaces.           |
| Use `${!array[@]}`       | Gets indices — useful for safe indexed iteration.                  |
| Bash 4+ only             | Associative arrays require Bash 4 or later.                        |
| Arrays persist in memory | If you reassign `array=("a")`, all previous elements are replaced. |

### Example: Combining everything

```bash
#!/bin/bash

fruits=("apple" "banana" "cherry" "kiwi")

echo "All fruits: ${fruits[@]}"
echo "Total: ${#fruits[@]}"

for i in "${!fruits[@]}"; do
  echo "Fruit $i: ${fruits[$i]}"
done

# Add a new one
fruits+=("mango")

# Check existence
[[ " ${fruits[@]} " =~ " mango " ]] && echo "Mango found!"
```
